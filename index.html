<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>IP Lat/Long Copy</title>
  <style>
    body {
      margin: 0;
      padding: 0;
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      height: 100vh;
      background-color: black;
      color: white;
      text-align: center;
    }

    button {
      width: 80%;
      max-width: 300px;
      padding: 18px;
      margin: 12px 0;
      font-size: 18px;
      border: none;
      border-radius: 12px;
      background: #007aff;
      color: white;
    }

    .infoBox {
      margin-top: 20px;
      font-size: 17px;
      line-height: 1.5;
      width: 90%;
      max-width: 350px;
    }
  </style>
</head>
<body>

  <button id="copyLat">Latitude kopieren</button>
  <button id="copyLong">Longitude kopieren</button>

  <div class="infoBox">
    <p><b>IP:</b> <span id="ip">-</span></p>
    <p><b>Standort:</b> <span id="location">-</span></p>
    <p><b>Trust Score:</b> <span id="trustScore">-</span></p>
  </div>

  <script>
    let lat = null;
    let lon = null;
    let userIP = null;

    const API_KEY = "0NZfP48YNIz1Z-ICI9yTYi7N7.tpsVWPSNyP6NlLPC87WN18EoGWHtbdmfGOC1kQ";

    const ipField = document.getElementById("ip");
    const locField = document.getElementById("location");
    const trustField = document.getElementById("trustScore");

    // --- 1) IP + Geolocation abrufen ---
    fetch("https://ipapi.co/json/")
      .then(res => res.json())
      .then(data => {
        userIP = data.ip;
        lat = data.latitude;
        lon = data.longitude;

        ipField.textContent = userIP;
        locField.textContent = lat + ", " + lon;

        // Danach Trust Score abrufen
        getTrustScore(userIP);
      })
      .catch(err => console.error("IP-Fehler:", err));

    // --- 2) Trust Score Ã¼ber APIVoid abrufen ---
    function getTrustScore(ip) {
      fetch(`https://endpoint.apivoid.com/iprep/v1/pay-as-you-go/?key=${API_KEY}&ip=${ip}`)
        .then(res => res.json())
        .then(data => {
          if (data && data.data && data.data.report) {
            const score = data.data.report.risk_score;
            trustField.textContent = score + "/100";
          } else {
            trustField.textContent = "Keine Daten";
          }
        })
        .catch(err => {
          trustField.textContent = "Fehler";
          console.error("TrustScore-API Fehler:", err);
        });
    }

    // --- 3) Kopierfunktionen ---
    function copy(text) {
      if (!text) return;
      navigator.clipboard.writeText(text.toString());
    }

    document.getElementById("copyLat").addEventListener("click", () => copy(lat));
    document.getElementById("copyLong").addEventListener("click", () => copy(lon));
  </script>

</body>
</html>
